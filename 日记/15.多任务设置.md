# 任务切换流程：
## 1.通过中断（抢占式切换）
通过定时器产生周期性中断，每次中断发生时，通过idt的任务门获取任务在gdt中的选择子，
之后cpu将当前tr寄存器的所指向的任务的各种状态存储到指向的TSS中，之后通过gdt中的任务描述符，找到对应的任务的位置，将其加载进tr寄存器中，之后cpu将新任务的TSS中存储的寄存器状态存储进个寄存器中，完成任务切换


## 2.手动切换

任务切换的核心是，各个独立，对于每一个任务而言，都有对应的特权级，运行位置。
操作系统实现的是任务之间独立，互不干扰，并且遵循一定调用规则的管理系统

如果任务A要切换到任务B，通过中断到达我们的中断函数，首先将任务A的状态压入A的TSS中，之后从任务队列里找到任务B，将任务B的任务描述符选择子加载进tr寄存器中（选择子是x8后的），通过tr寄存器的值获取新任务的TSS，恢复新任务的TSS,实现任务切换。

![](http://tk.heiblog.top/Snipaste_2023-05-10_09-20-01.jpg)